<!doctype html>
<html ng-app="myApp">

	<head>
		<title>Interpolate String Template Example</title>
		<script src="/learn-angular/app/bower_components/angular/angular.js"></script>
	</head>

	<body>

		<div id="emailEditor" ng-controller="MyController">
			<input ng-model="to22" type="email" placeholder="Recipient" />
			<textarea ng-model="emailBody"></textarea>

			<div id="emailPreview">
				<pre>__ previewText __</pre>
			</div>
		</div>

		<script>
			/**
			 *  to 貌似是关键字，源代码中使用的是to,无法正常获取到值
			 */
		
			// to see this example in action open in your browser, type
			// an email address into the email field. Then in the text area
			// box type: Hello {{ to }}.
			angular.module('myApp', ['emailParser'])
				.controller('MyController', ['$scope', 'EmailParser',
					function($scope, EmailParser) {
						// Set up a watch
						$scope.$watch('emailBody', function(body) {
							if (body) {
								
								console.log( $scope.to22 )
								
								$scope.previewText =
									EmailParser.parse(body, {
										to: $scope.to22
									});
							}
						});
					}
				]);
			angular.module('emailParser', [])
				.config(['$interpolateProvider',
					function($interpolateProvider) {
						$interpolateProvider.startSymbol('__');
						$interpolateProvider.endSymbol('__');
					}
				])
				.factory('EmailParser', ['$interpolate',
					function($interpolate) {
						// a service to handle parsing
						return {
							parse: function(text, context) {
								
								console.info( 'text = ' + text);
								var template = $interpolate(text);
								
								console.info ( template(context) );
								
								return template('1' + context + '2');
							}
						};
					}
				]);
		</script>

	</body>

</html>